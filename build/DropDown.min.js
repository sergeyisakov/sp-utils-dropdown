(function(){var a;a=function(a,b){var c,d,e,f,g,h;return h=b(a.View),c=a.$,g=a.Model.extend({defaults:{text:"",value:"",active:!1}}),d=a.Collection.extend({model:g}),e=h.extend({className:"dropdown_item",tagName:"li",events:{click:"onClick"},initialize:function(){return this.listenTo(this.model,{"change:text":this.onTextChange,"change:active":this.onActiveChange}),this.updateText(),this.updateActive()},updateText:function(){return this.$el.text(this.model.get("text"))},updateActive:function(){return this.model.get("active")?this.$el.addClass("active"):this.$el.removeClass("active")},onTextChange:function(){return this.updateText()},onActiveChange:function(){return this.updateActive()},onClick:function(){return this.model.set({active:!0})}}),f=h.extend({OPEN_CLASS:"open",className:"dropdown_list",itemView:e,templateFunc:function(){return"<button class=dropdown-list-button type='button'></button> <ul class=dropdown-list-menu></ul>"},ui:{menu:".dropdown-list-menu",button:".dropdown-list-button"},events:{click:"onClick"},initialize:function(){return this.collection=new d,this.listenTo(this.collection,{"change:active":this.onChangeCollectionActive,add:this.onAddCollection,remove:this.onRemoveCollection}),this.currentActiveModel=null,this.isMenuOpen=!1,this.views={},this.__onBackdropClick=function(a){return function(b){return a.onBackdropClick(b)}}(this)},onShow:function(){return c(window).on("click",this.__onBackdropClick)},onClose:function(){return c(window).off("click",this.__onBackdropClick)},bindToInput:function(a){this.$input=a},setButtonText:function(a){return this.ui.button.text(a)},setData:function(a){return this.collection.remove(this.collection.models),this.collection.add(a)},onClick:function(){return this.isMenuOpen?(this.$el.removeClass(this.OPEN_CLASS),this.isMenuOpen=!1):(this.$el.addClass(this.OPEN_CLASS),this.isMenuOpen=!0)},onBackdropClick:function(a){var b;return b=c(a.target).parents("."+this.className)[0]===this.el,!b&&this.isMenuOpen?(this.$el.removeClass(this.OPEN_CLASS),this.isMenuOpen=!1):void 0},onAddCollection:function(a){var b;return this.views[a.cid]=b=new this.itemView({model:a}),this.ui.menu.append(b.$el)},onRemoveCollection:function(a){return this.views[a.cid].remove()},onChangeCollectionActive:function(a,b){var c;if(b)return null!=(c=this.currentActiveModel)&&c.set({active:!1}),this.currentActiveModel=a,this.$input.val(a.get("value")),this.$input.trigger("change"),this.setButtonText(a.get("text"))}}),f.version="0.0.4",f},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(["backbone","backbone-mixin"],function(b,c){return a(b,c)}):window.DropDown=a(Backbone,MixinBackbone)}).call(this);